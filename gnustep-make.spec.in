#
# This file is to be manually edited
#
# This package is not relocatable
#
%define gs_version	@GNUSTEP_MAKE_VERSION@
%define gs_name         gnustep-make
%define gs_prefix 	/usr/GNUstep
%define libcombo        gnu-gnu-gnu-xgps
#
Name: 		%{gs_name}
Version: 	%{gs_version}
Release: 	1
Source: 	ftp://ftp.gnustep.org/pub/gnustep/core/%{gs_name}-%{gs_version}.tar.gz
Copyright: 	GPL
Group: 		System Environment/Base
Summary: 	GNUstep Makefile package
Packager:	Adam Fedor <fedor@gnu.org>
Vendor:		The GNUstep Project
URL:		http://www.gnustep.org/
BuildRoot: 	/var/tmp/build-%{gs_name}
#
# NB: This package is configured for use with:
#
# libxml.so.2 >= 2.2.3
# openssl => 0.9.5
# libwraster
# libtiff
# <FIXME: Fill in all the requirements>
#
# `Requires' lines for this packages have to be included into gnustep-base 
# gnustep-gui and gnustep-xgps.  Also, gnustep-base, gnustep-gui and 
# gnustep-xgps have to be packaged at the same time as this gnustep-make, 
# and must depend on this version of gnustep-make.
#
# We don't add the Requires here because - while the thing is configured 
# for those libraries - it doesn't need them - gnustep-base, gnustep-xgps 
# etc will need them - and we don't want to force people to install 
# eg gui libraries if they are only going to use gnustep-base.
#

%description
This package contains the basic scripts, makefiles and directory layout
needed to run and compile any GNUstep software.  This package was configured
for library combo %{libcombo}.

%prep
%setup -n %{gs_name}-%{gs_version}

%build
CFLAGS="$RPM_OPT_FLAGS" ./configure --prefix=%{gs_prefix} --with-library-combo=%{libcombo}
make

%install
make install prefix=${RPM_BUILD_ROOT}%{gs_prefix}/System

%ifos Linux
mkdir -p ${RPM_BUILD_ROOT}/etc/profile.d

# Create profile files

echo "#!/bin/sh" > mygnustep.sh
echo ". %{gs_prefix}/System/Makefiles/GNUstep.sh" >> mygnustep.sh

echo "#!/bin/csh" > mygnustep.csh
echo "source %{gs_prefix}/System/Makefiles/GNUstep.csh" >> mygnustep.csh

chmod 755 mygnustep.*
mv mygnustep.sh $RPM_BUILD_ROOT/etc/profile.d/GNUstep.sh
mv mygnustep.csh $RPM_BUILD_ROOT/etc/profile.d/GNUstep.csh
%endif # Linux

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr (-, root, root)

# Well - this is the simplest trick you could think of.  We include in
# the package everything which was installed inside /usr/GNUstep/
%{gs_prefix}

# Add the profiles for linux as configuration files <FIXME gdomap etc>
%ifos Linux
%config /etc/profile.d/GNUstep.sh
%config /etc/profile.d/GNUstep.csh
%endif # Linux

%changelog
* Wed Jan 17 2001  Nicola Pero  <nicola@brainstorm.co.uk>
- Updated; heavily simplified and mostly rewritten

* Sat Sep 18 1999 Christopher Seawood <cls@seawood.org>
- Version 0.6.0
- Added nodupsh patch

* Sat Aug 07 1999 Christopher Seawood <cls@seawood.org>
- Updated to cvs dawn_6 branch

* Fri Jun 25 1999 Christopher Seawood <cls@seawood.org>
- Split into separate rpm from gnustep-core
- Build from cvs snapshot
- Added services patch

